/**
 * Combined ROM Table Styles
 * Streamlined table for AROM, PROM, and RIMs
 *
 * Aligned with Table Design System tokens:
 * - --table-border-width, --table-cell-border-width
 * - --table-radius-outer, --table-radius-inner
 * - --table-border-color, --table-cell-border-color
 */

/* Use higher specificity to override generic .table styles */
table.combined-rom-table {
  width: 100%;
  border-collapse: separate !important;
  border-spacing: 0;
  background: var(--surface);
  border: var(--table-border-width) solid var(--table-border-color);
  border-radius: var(--table-radius-outer);
  overflow: visible !important; /* Allow dropdowns to extend outside table */
  box-shadow: var(--elev-hero-lg);
}

/* Dark theme table */
:root[data-theme='dark'] .combined-rom-table {
  box-shadow: var(--elev-hero);
}

.combined-rom-thead {
  background: var(--surface-table-head);
  color: var(--table-head-text);
  position: sticky;
  top: 0;
  z-index: 10;
}

/* Dark theme header */
:root[data-theme='dark'] .combined-rom-thead {
  box-shadow: var(--elev-soft);
}

/* Base header cell styles */
.combined-rom-th {
  padding: 0.6rem 0.5rem;
  text-align: center;
  font-weight: 600;
  background: var(--surface-table-head);
  color: var(--table-head-text);
  border: none;
  border-bottom: var(--table-border-width) solid var(--table-border-color);
}

/* Dark theme column headers - tokens handle theme switching */
:root[data-theme='dark'] .combined-rom-th {
  background: var(--surface-table-head);
  color: var(--table-head-text);
  border-bottom: var(--table-border-width) solid var(--table-border-color);
}

/* Motion column (green accent) - label column */
.combined-rom-th.motion-col {
  text-align: left;
  vertical-align: middle;
  width: 15%;
  background: var(--und-green);
  color: var(--white);
  font-weight: 600;
  font-size: 1.125rem;
  padding-left: 0.75rem;
  border-right: var(--table-border-width) solid var(--table-border-color);
  border-bottom: var(--table-border-width) solid var(--table-border-color);
  /* Only outer table corner - top-left */
  border-top-left-radius: calc(var(--table-radius-inner) - 1px);
}

/* Top-right corner - outer table corner on right-group header */
.combined-rom-thead tr:first-child .combined-rom-th.right-group {
  border-top-right-radius: calc(var(--table-radius-inner) - 1px);
}

/* Dark theme motion column - keep UND Green */
:root[data-theme='dark'] .combined-rom-th.motion-col {
  background: var(--und-green);
  color: var(--white);
}

/* Group headers (Left/Right spanning columns) */
.combined-rom-th.left-group,
.combined-rom-th.right-group {
  background: var(--surface-table-head);
  color: var(--table-head-text);
  font-weight: 600;
  font-size: 1.05rem;
  border-bottom: var(--table-border-width) solid var(--table-border-color);
}

/* Vertical divider before Right group - matches outer table border */
.combined-rom-th.right-group {
  border-left: var(--table-border-width) solid var(--table-border-color);
}

/* Dark theme group headers - tokens handle theme switching */
:root[data-theme='dark'] .combined-rom-th.left-group,
:root[data-theme='dark'] .combined-rom-th.right-group {
  background: var(--surface-table-head);
  color: var(--table-head-text);
  border-bottom: var(--table-border-width) solid var(--table-border-color);
}

/* normal-col removed when Normal column was removed */

.combined-rom-th.sub-header {
  font-size: 0.9rem;
  font-weight: 500;
  padding: 0.5rem 0.25rem;
  border-right: var(--table-cell-border-width) solid var(--table-cell-border-color);
}

/* Remove right border from last sub-header in each group */
.combined-rom-thead tr:nth-child(2) th:nth-child(2),
.combined-rom-thead tr:nth-child(2) th:last-child {
  border-right: none;
}

/* Heavy vertical divider before Right group sub-headers (major group separator) - matches outer table border */
.combined-rom-th.sub-header.divider-left {
  border-left: var(--table-border-width) solid var(--table-border-color);
}

/* Center group headers explicitly */
.combined-rom-thead .left-group,
.combined-rom-thead .right-group {
  text-align: center;
}

/* Center RIM, right-align AROM and PROM */
.combined-rom-thead .sub-header:nth-child(3),
.combined-rom-thead .sub-header:nth-child(6) {
  text-align: center; /* RIM columns */
}

.combined-rom-thead .sub-header:nth-child(1),
.combined-rom-thead .sub-header:nth-child(2),
.combined-rom-thead .sub-header:nth-child(4),
.combined-rom-thead .sub-header:nth-child(5) {
  text-align: right; /* AROM and PROM columns */
  padding-right: 0.75rem;
}

/* Row hover states - UND green tint */
.combined-rom-tbody .combined-rom-row:hover .combined-rom-td {
  background: var(--table-row-hover) !important;
}

/* Dark theme row hover - darker green tint */
:root[data-theme='dark'] .combined-rom-tbody .combined-rom-row:hover .combined-rom-td {
  background: var(--table-row-hover-accent) !important;
}

/* Motion cell hover - darker UND green to lead the row */
.combined-rom-tbody .combined-rom-row:hover .motion-cell {
  background: var(--table-row-hover-strong) !important;
}

/* Dark theme motion cell hover - even darker green */
:root[data-theme='dark'] .combined-rom-tbody .combined-rom-row:hover .motion-cell {
  background: var(--table-row-hover-accent-strong) !important;
}

/* Dark theme motion cell hover - brighten slightly */
:root[data-theme='dark'] .combined-rom-tbody .combined-rom-row:hover .motion-cell {
  background: var(--neutral-800);
  color: var(--white);
}

.combined-rom-td {
  padding: 0.5rem;
  border: none;
  border-bottom: var(--table-cell-border-width) solid var(--table-cell-border-color);
  border-right: var(--table-cell-border-width) solid var(--table-cell-border-color);
  text-align: center;
  transition: background 150ms ease-in-out;
}

/* Remove right border from last cell in each group */
.combined-rom-tbody tr td:nth-child(3),
.combined-rom-tbody tr td:last-child {
  border-right: none;
}

/* Heavy vertical divider between Left and Right data groups (major group separator) - matches outer table border */
.combined-rom-td.divider-left {
  border-left: var(--table-border-width) solid var(--table-border-color);
}

/* Zebra striping applied to cells - odd rows (default white) */
.combined-rom-tbody .combined-rom-row:nth-child(odd) .combined-rom-td {
  background: var(--white);
}

/* Zebra striping applied to cells - even rows */
.combined-rom-tbody .combined-rom-row:nth-child(even) .combined-rom-td {
  background: var(--neutral-50);
}

/* Dark theme data cells - odd rows */
:root[data-theme='dark'] .combined-rom-tbody .combined-rom-row:nth-child(odd) .combined-rom-td {
  background: var(--neutral-850);
  border-bottom-color: var(--neutral-750);
}

/* Dark theme data cells - even rows */
:root[data-theme='dark'] .combined-rom-tbody .combined-rom-row:nth-child(even) .combined-rom-td {
  background: var(--neutral-875);
  border-bottom-color: var(--neutral-750);
}

/* Ensure borders are consistent inside Regional Assessment context where
   generic table rules remove borders. Increase specificity to win. */
.regional-assessment .combined-rom-table th.combined-rom-th,
.regional-assessment .combined-rom-table td.combined-rom-td {
  border: var(--table-cell-border-width) solid var(--table-cell-border-color);
}

/* Motion cell in data rows */
.combined-rom-td.motion-cell {
  text-align: left;
  font-weight: 600;
  border-right: var(--table-border-width) solid var(--table-border-color);
  border-bottom: var(--table-cell-border-width) solid var(--table-cell-border-color);
  padding-left: 0.75rem;
  transition: background 150ms ease-in-out;
}

/* Bottom-left corner - outer table corner */
.combined-rom-tbody tr:last-child .combined-rom-td.motion-cell {
  border-bottom-left-radius: calc(var(--table-radius-inner) - 1px);
}

/* Bottom-right corner - outer table corner */
.combined-rom-tbody tr:last-child .combined-rom-td:last-child {
  border-bottom-right-radius: calc(var(--table-radius-inner) - 1px);
}

/* Remove bottom border from last row - table border handles it */
.combined-rom-tbody tr:last-child .combined-rom-td {
  border-bottom: none;
}

/* Dark theme: also remove bottom border from last row (match specificity of nth-child rules) */
:root[data-theme='dark'] .combined-rom-tbody .combined-rom-row:last-child .combined-rom-td {
  border-bottom: none;
}

/* Dark theme motion cell */
:root[data-theme='dark'] .combined-rom-td.motion-cell {
  color: var(--white);
  border-right: var(--table-border-width) solid var(--table-border-color);
  border-bottom-color: var(--neutral-750);
}

/* Dark theme: last row motion cell - ensure no bottom border (match specificity) */
:root[data-theme='dark']
  .combined-rom-tbody
  .combined-rom-row:last-child
  .combined-rom-td.motion-cell {
  border-bottom: none;
}

.combined-rom-td.normal-cell {
  color: var(--text-muted);
  font-size: 0.9rem;
}

.combined-rom-td.empty-cell {
  color: var(--text-muted);
  background: var(--surface-secondary);
  font-style: italic;
  opacity: 0.6;
}

.combined-rom-td.input-cell,
.combined-rom-td.select-cell {
  padding: 0.25rem;
  /* Transition inherited from .combined-rom-td */
}

/* Individual cell hover is overridden by row hover, so we can remove these */

/* Increase right padding on AROM/PROM cells to give the ° breathing room from the cell edge */
.combined-rom-td.input-cell {
  padding-right: 0.75rem;
}

/* Ensure RIM columns are wide enough to keep text on one line */
.combined-rom-td.select-cell,
.combined-rom-thead tr:nth-child(2) th:nth-child(3), /* Left RIM */
.combined-rom-thead tr:nth-child(2) th:nth-child(6)  /* Right RIM */ {
  min-width: 12rem;
}

/* Narrow AROM/PROM columns so they don't sprawl */
.combined-rom-thead tr:nth-child(2) th:nth-child(1), /* Left AROM */
.combined-rom-thead tr:nth-child(2) th:nth-child(2), /* Left PROM */
.combined-rom-thead tr:nth-child(2) th:nth-child(4), /* Right AROM */
.combined-rom-thead tr:nth-child(2) th:nth-child(5)  /* Right PROM */ {
  width: 7rem;
}
.combined-rom-tbody td:nth-child(2), /* Left AROM */
.combined-rom-tbody td:nth-child(3), /* Left PROM */
.combined-rom-tbody td:nth-child(5), /* Right AROM */
.combined-rom-tbody td:nth-child(6)  /* Right PROM */ {
  width: 7rem;
}

/* Input with suffix wrapper: right-justify contents */
.input-with-suffix {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 0.25rem; /* tighter spacing between input and ° */
  width: 100%;
}

/* Make the input visible with border like Vitals table */
input[data-component='combined-rom'][data-element='input'] {
  width: 3.5rem;
  text-align: center;
  padding: 0.25rem; /* Compact to match Vitals inputs */
  background: var(--neutral-50);
  border: var(--table-cell-border-width) solid var(--table-cell-border-color);
  border-radius: var(--radius-sm, 4px);
  font-size: var(--table-font-size, 0.875rem);
  color: var(--text-primary);
  transition:
    border-color 0.2s,
    background-color 0.2s;
}

/* Focus state with green border */
input[data-component='combined-rom'][data-element='input']:focus,
input[data-component='combined-rom'][data-element='input']:focus-visible {
  outline: none;
  border-color: var(--und-green);
  background: var(--white);
  box-shadow: var(--table-focus-ring);
}

/* Hover state */
input[data-component='combined-rom'][data-element='input']:hover {
  border-color: var(--und-green-light, #66bb6a);
}

/* Dark mode */
:root[data-theme='dark'] input[data-component='combined-rom'][data-element='input'] {
  background: var(--neutral-700);
  border-color: var(--neutral-600);
}

:root[data-theme='dark'] input[data-component='combined-rom'][data-element='input']:focus {
  background: var(--neutral-800);
  border-color: var(--und-green-light);
}

/* Degree symbol pinned at the far right side of the cell */
.combined-rom-table .input-with-suffix .input-suffix {
  position: static;
  pointer-events: none;
  color: var(--text-muted);
  font-size: 0.9rem;
  font-weight: 500;
}

/* Hide placeholder if any remains */
input[data-component='combined-rom'][data-element='input']::placeholder {
  color: transparent;
}

/* Future-proof: hide number spinners if input type changes to number */
.combined-rom-table input[type='number']::-webkit-outer-spin-button,
.combined-rom-table input[type='number']::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}
.combined-rom-table input[type='number'] {
  -moz-appearance: textfield;
  appearance: textfield;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .combined-rom-th,
  .combined-rom-td {
    padding: 0.375rem 0.25rem;
    font-size: 0.85rem;
  }

  .combined-rom-th.sub-header {
    font-size: 0.8rem;
    padding: 0.375rem 0.125rem;
  }

  .input-with-suffix .combined-rom-input {
    max-width: 3.125rem;
    font-size: 0.85rem;
  }

  .combined-rom-select {
    font-size: 0.8rem;
  }

  /* Slightly reduce RIM column min-width on small screens; allow horizontal scroll if needed */
  .combined-rom-td.select-cell,
  .combined-rom-thead tr:nth-child(2) th:nth-child(3),
  .combined-rom-thead tr:nth-child(2) th:nth-child(6) {
    min-width: 10rem;
  }

  /* Also scale down AROM/PROM widths a bit on small screens */
  .combined-rom-thead tr:nth-child(2) th:nth-child(1),
  .combined-rom-thead tr:nth-child(2) th:nth-child(2),
  .combined-rom-thead tr:nth-child(2) th:nth-child(4),
  .combined-rom-thead tr:nth-child(2) th:nth-child(5),
  .combined-rom-tbody td:nth-child(2),
  .combined-rom-tbody td:nth-child(3),
  .combined-rom-tbody td:nth-child(5),
  .combined-rom-tbody td:nth-child(6) {
    width: 6rem;
  }
}
